<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EL AI Gambar</title>
<link rel="stylesheet" href="ai.css">
</head>

<body class="chat-bg">

<header class="chat-header">üé® EL AI Gambar</header>

<div class="chat-box">

  <div class="message ai">
    Pilih gaya atau tulis deskripsi gambar.
  </div>

  <!-- PRESET -->
  <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px">
    <button onclick="setPreset('Anime style, highly detailed, vibrant colors')" class="menu-btn ghost">Anime</button>
    <button onclick="setPreset('Realistic photo, ultra HD, cinematic lighting')" class="menu-btn ghost">Realistic</button>
    <button onclick="setPreset('Cyberpunk futuristic, neon lights')" class="menu-btn ghost">Cyberpunk</button>
  </div>

  <!-- INPUT -->
  <div class="input-area">
    <input id="promptInput" placeholder="Contoh: Kucing robot di kota futuristik" />
    <button onclick="generateImage()">‚û§</button>
  </div>

  <!-- RESULT -->
  <div id="imageResult" style="margin-top:16px"></div>

  <!-- HISTORY -->
  <div id="history" style="margin-top:20px"></div>

</div>

<script>
const historyEl = document.getElementById("history");

function setPreset(text){
  document.getElementById("promptInput").value = text;
}

async function generateImage(){
  const prompt = document.getElementById("promptInput").value.trim();
  const result = document.getElementById("imageResult");

  if(!prompt){
    alert("Masukkan deskripsi gambar");
    return;
  }

  result.innerHTML = "<div class='message ai'>‚è≥ Membuat gambar...</div>";

  try{
    const res = await fetch("/api/image",{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({ prompt })
    });

    const data = await res.json();

    if(data.image){
      const imgHTML = `
        <div class="message ai">
          <img src="${data.image}" style="width:100%;border-radius:16px;margin-bottom:10px">
          <a href="${data.image}" download class="menu-btn primary">‚¨á Download</a>
        </div>
      `;

      result.innerHTML = imgHTML;
      historyEl.innerHTML = imgHTML + historyEl.innerHTML;
    }else{
      result.innerHTML = "<div class='message ai'>Gagal membuat gambar.</div>";
    }

  }catch{
    result.innerHTML = "<div class='message ai'>Server error.</div>";
  }
}
</script>

</body>
</html>
